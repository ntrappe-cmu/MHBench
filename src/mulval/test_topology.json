{
  "name": "test_topology",
  "networks": [
    {
      "name": "test_network",
      "description": "Test network with 2 subnets",
      "subnets": [
        {
          "id": "sub0-id",
          "name": "subnet_0",
          "cidr": "192.168.200.0/24",
          "dns_servers": ["8.8.8.8"],
          "hosts": [
            {
              "id": "host0-id",
              "name": "host_0_subnet_0",
              "os_type": "Ubuntu20",
              "flavor": "p2.tiny",
              "ip_address": "192.168.200.10",
              "users": [
                {"id": "u0-id", "username": "user_0", "password": "perry123", "is_admin": false, "is_decoy": false, "ssh_keys": [], "home_directory": "/home/user_0"},
                {"id": "u0r-id", "username": "root", "password": "perry123", "is_admin": true, "is_decoy": false, "ssh_keys": [], "home_directory": "/root"}
              ],
              "vulnerabilities": [
                {
                  "type": "lateral_movement",
                  "playbook_path": "vulnerabilities/NetcatShell.yml",
                  "merge_strategy": "by_host",
                  "internal_only": false,
                  "from_host_ip": "None",
                  "to_host_ip": "192.168.200.10",
                  "from_user": "root",
                  "to_user": "user_0"
                },
                {
                  "type": "lateral_movement",
                  "playbook_path": "vulnerabilities/apacheStruts/setupStruts.yml",
                  "merge_strategy": "by_host",
                  "internal_only": false,
                  "from_host_ip": "None",
                  "to_host_ip": "192.168.200.10",
                  "from_user": "root",
                  "to_user": "root"
                }
              ],
              "is_attacker": false,
              "is_decoy": false
            },
            {
              "id": "host1-id",
              "name": "host_1_subnet_0",
              "os_type": "Ubuntu20",
              "flavor": "p2.tiny",
              "ip_address": "192.168.200.11",
              "users": [
                {"id": "u1-id", "username": "user_1", "password": "perry123", "is_admin": false, "is_decoy": false, "ssh_keys": [], "home_directory": "/home/user_1"},
                {"id": "u1r-id", "username": "root", "password": "perry123", "is_admin": true, "is_decoy": false, "ssh_keys": [], "home_directory": "/root"}
              ],
              "vulnerabilities": [
                {
                  "type": "lateral_movement",
                  "playbook_path": "deployment_instance/setup_server_ssh_keys/setup_ssh_keys.yml",
                  "merge_strategy": "by_host",
                  "internal_only": false,
                  "from_host_ip": "192.168.200.10",
                  "to_host_ip": "192.168.200.11",
                  "from_user": "user_0",
                  "to_user": "user_1"
                }
              ],
              "is_attacker": false,
              "is_decoy": false
            }
          ],
          "gateway_ip": null,
          "external": true,
          "sg_name": "subnet_0_sg"
        },
        {
          "id": "sub1-id",
          "name": "subnet_1",
          "cidr": "192.168.201.0/24",
          "dns_servers": ["8.8.8.8"],
          "hosts": [
            {
              "id": "host2-id",
              "name": "host_0_subnet_1",
              "os_type": "Ubuntu20",
              "flavor": "p2.tiny",
              "ip_address": "192.168.201.10",
              "users": [
                {"id": "u2-id", "username": "user_0", "password": "perry123", "is_admin": false, "is_decoy": false, "ssh_keys": [], "home_directory": "/home/user_0"},
                {"id": "u2r-id", "username": "root", "password": "perry123", "is_admin": true, "is_decoy": false, "ssh_keys": [], "home_directory": "/root"}
              ],
              "vulnerabilities": [
                {
                  "type": "lateral_movement",
                  "playbook_path": "vulnerabilities/NetcatShell.yml",
                  "merge_strategy": "by_host",
                  "internal_only": false,
                  "from_host_ip": "192.168.200.10",
                  "to_host_ip": "192.168.201.10",
                  "from_user": "root",
                  "to_user": "user_0"
                }
              ],
              "is_attacker": false,
              "is_decoy": false
            },
            {
              "id": "host3-id",
              "name": "host_1_subnet_1",
              "os_type": "Ubuntu20",
              "flavor": "p2.tiny",
              "ip_address": "192.168.201.11",
              "users": [
                {"id": "u3-id", "username": "user_1", "password": "perry123", "is_admin": false, "is_decoy": false, "ssh_keys": [], "home_directory": "/home/user_1"},
                {"id": "u3r-id", "username": "root", "password": "perry123", "is_admin": true, "is_decoy": false, "ssh_keys": [], "home_directory": "/root"}
              ],
              "vulnerabilities": [
                {
                  "type": "privilege_escalation",
                  "playbook_path": "vulnerabilities/privledge_escalation/writeablePasswd/writeablePasswd.yml",
                  "merge_strategy": "by_host",
                  "internal_only": false,
                  "from_host_ip": "",
                  "to_host_ip": "192.168.201.11",
                  "from_user": "",
                  "to_user": ""
                }
              ],
              "is_attacker": false,
              "is_decoy": false
            }
          ],
          "gateway_ip": null,
          "external": false,
          "sg_name": "subnet_1_sg"
        }
      ],
      "is_external": false
    }
  ],
  "subnet_connections": [
    {
      "from_subnet": "subnet_0",
      "to_subnet": "subnet_1",
      "protocol": null,
      "ports": null,
      "bidirectional": true
    }
  ],
  "goals": [
    {
      "type": "data_exfiltration",
      "target_host_id": "host3-id",
      "target_user_id": "u3r-id",
      "playbook_path": "goals/data/addData.yml",
      "host_ip": "192.168.201.11",
      "src_path": "data.json",
      "dst_path": "/root/data_host_1_subnet_1.json",
      "host_user": "root"
    }
  ],
  "attack_paths": [],
  "attacker_host": {
    "id": "attacker-id",
    "name": "external_attacker",
    "os_type": "KaliLinux",
    "flavor": "p2.tiny",
    "ip_address": null,
    "users": [
      {"id": "att-user-id", "username": "root", "password": "perry123", "is_admin": true, "is_decoy": false, "ssh_keys": [], "home_directory": "/root"}
    ],
    "vulnerabilities": [],
    "is_attacker": false,
    "is_decoy": false
  }
}
